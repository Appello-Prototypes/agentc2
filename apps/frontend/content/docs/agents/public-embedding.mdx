---
title: "Public Embedding"
description: "Embed agents on external websites with token controls, branding, and abuse prevention."
section: "agents"
order: 14
primaryKeyword: "embed AI agent website"
relatedSlugs: ["agents/guardrails", "channels/embed"]
pageType: "how-to"
---

# Public Embedding

Public embedding enables you to serve agents as interactive chat widgets on any website without requiring user authentication. Agents can be embedded with customizable branding, token-based access control, rate limiting, and abuse prevention measures.

## What is Public Embedding?

Public embedding allows you to embed an agent as a chat interface on external websites. Visitors can interact with the agent directly without signing up or logging in. The embed uses a public token for authentication and includes built-in protections against abuse.

### Key Features

- **No authentication required** — Visitors can chat without accounts
- **Token-based access** — Each embed uses a unique public token
- **Customizable branding** — Theme, logo, welcome message, and more
- **Rate limiting** — Prevent abuse with configurable limits
- **CORS protection** — Restrict which domains can embed your agent
- **Content filtering** — Built-in guardrails prevent harmful content

<Callout type="info">
    Public embedding is separate from authenticated agent access. Public embeds use tokens, while
    authenticated access uses session cookies or API keys.
</Callout>

## Setting Up Embed

### Step 1: Configure Agent Visibility

Set the agent's visibility to `PUBLIC` and generate a public token:

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "visibility": "PUBLIC"
  }'
```

The API automatically generates a `publicToken` if one doesn't exist:

```json
{
    "success": true,
    "agent": {
        "id": "cm_abc123",
        "slug": "support-agent",
        "visibility": "PUBLIC",
        "publicToken": "pub_xyz789abcdef",
        "isActive": true
    }
}
```

### Step 2: Get Embed Configuration

Retrieve embed configuration and code:

```bash
curl "https://agentc2.ai/agent/api/agents/support-agent/embed?token=pub_xyz789abcdef" \
  -H "Authorization: Bearer $TOKEN"
```

Response includes embed configuration:

```json
{
    "success": true,
    "config": {
        "greeting": "Hi, I'm Support Agent. How can I help you?",
        "suggestions": ["Ask a question", "Get help", "Contact support"],
        "theme": "dark",
        "showToolActivity": true,
        "showModeSelector": false,
        "showModelSelector": false,
        "showFileUpload": false,
        "showVoiceInput": false,
        "showConversationSidebar": false,
        "showSignupCTA": false,
        "signupProviders": ["google"],
        "poweredByBadge": true,
        "maxMessagesPerSession": 50
    },
    "embedUrl": "https://agentc2.ai/embed/support-agent?token=pub_xyz789abcdef"
}
```

### Step 3: Generate Embed Code

Get HTML embed code snippet:

```bash
curl "https://agentc2.ai/agent/api/agents/support-agent/embed?token=pub_xyz789abcdef&format=embed-code" \
  -H "Authorization: Bearer $TOKEN"
```

Returns HTML snippet:

```html
<iframe
    src="https://agentc2.ai/embed/support-agent?token=pub_xyz789abcdef"
    width="100%"
    height="600"
    frameborder="0"
    allow="microphone"
></iframe>
```

## Embed Code Snippet

### Iframe Embed

The simplest way to embed an agent is using an iframe:

```html
<iframe
    src="https://agentc2.ai/embed/support-agent?token=pub_xyz789abcdef"
    width="100%"
    height="600"
    frameborder="0"
    allow="microphone"
    style="border: none; border-radius: 8px;"
></iframe>
```

### Script Tag Embed

For more control, use the JavaScript embed:

```html
<div id="agentc2-embed"></div>
<script>
    (function () {
        const iframe = document.createElement("iframe");
        iframe.src = "https://agentc2.ai/embed/support-agent?token=pub_xyz789abcdef";
        iframe.width = "100%";
        iframe.height = "600";
        iframe.frameBorder = "0";
        iframe.allow = "microphone";
        iframe.style.border = "none";
        iframe.style.borderRadius = "8px";
        document.getElementById("agentc2-embed").appendChild(iframe);
    })();
</script>
```

### React Component

For React applications:

```tsx
import { useEffect, useRef } from "react";

export function AgentEmbed({ agentSlug, token }: { agentSlug: string; token: string }) {
    const containerRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        if (!containerRef.current) return;

        const iframe = document.createElement("iframe");
        iframe.src = `https://agentc2.ai/embed/${agentSlug}?token=${token}`;
        iframe.width = "100%";
        iframe.height = "600";
        iframe.frameBorder = "0";
        iframe.allow = "microphone";
        iframe.style.border = "none";
        iframe.style.borderRadius = "8px";

        containerRef.current.appendChild(iframe);

        return () => {
            if (containerRef.current && containerRef.current.contains(iframe)) {
                containerRef.current.removeChild(iframe);
            }
        };
    }, [agentSlug, token]);

    return <div ref={containerRef} />;
}
```

## Customization Options

Configure embed appearance and behavior via agent metadata:

### Theme Configuration

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "metadata": {
      "publicEmbed": {
        "theme": "light",
        "greeting": "Welcome! How can I help you today?",
        "suggestions": ["Get started", "Learn more", "Contact us"],
        "logo": "https://example.com/logo.png",
        "primaryColor": "#0066cc",
        "showToolActivity": false,
        "showSignupCTA": true,
        "poweredByBadge": false
      }
    }
  }'
```

### Available Options

| Option                    | Type                  | Default          | Description                       |
| ------------------------- | --------------------- | ---------------- | --------------------------------- |
| `theme`                   | `"dark"` \| `"light"` | `"dark"`         | Color theme                       |
| `greeting`                | string                | Agent name       | Welcome message                   |
| `suggestions`             | string[]              | `[]`             | Suggested message buttons         |
| `logo`                    | string (URL)          | —                | Logo image URL                    |
| `primaryColor`            | string (hex)          | Platform default | Primary accent color              |
| `showToolActivity`        | boolean               | `true`           | Show tool call indicators         |
| `showModeSelector`        | boolean               | `false`          | Show mode selector (chat/voice)   |
| `showModelSelector`       | boolean               | `false`          | Show model selector               |
| `showFileUpload`          | boolean               | `false`          | Enable file upload                |
| `showVoiceInput`          | boolean               | `false`          | Enable voice input                |
| `showConversationSidebar` | boolean               | `false`          | Show conversation history sidebar |
| `showSignupCTA`           | boolean               | `false`          | Show sign-up call-to-action       |
| `signupProviders`         | string[]              | `["google"]`     | OAuth providers for sign-up       |
| `poweredByBadge`          | boolean               | `true`           | Show "Powered by AgentC2" badge   |
| `maxMessagesPerSession`   | number                | `50`             | Maximum messages per session      |

## Token Controls and Rate Limiting

### Rate Limiting

Configure rate limits per IP address:

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "metadata": {
      "publicEmbed": {
        "rateLimit": 20
      }
    }
  }'
```

This limits each IP address to 20 requests per minute. Exceeding the limit returns:

```json
{
    "success": false,
    "error": "Rate limit exceeded",
    "retryAfter": 60
}
```

### Token Rotation

Rotate public tokens for security:

```bash
# Generate new token
curl -X POST https://agentc2.ai/agent/api/agents/support-agent/rotate-token \
  -H "Authorization: Bearer $TOKEN"
```

Response includes new token:

```json
{
    "success": true,
    "publicToken": "pub_newtoken123",
    "expiresAt": null
}
```

Update your embed code with the new token. Old tokens are immediately invalidated.

## Abuse Prevention

### CORS Protection

Restrict which domains can embed your agent:

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "metadata": {
      "publicEmbed": {
        "allowedOrigins": [
          "https://example.com",
          "https://www.example.com"
        ]
      }
    }
  }'
```

Requests from other domains are blocked with:

```json
{
    "success": false,
    "error": "CORS policy violation"
}
```

### Content Filtering

Public embeds automatically apply agent guardrails:

- **Input policies** — Filter harmful or inappropriate user inputs
- **Output policies** — Prevent agent from generating unsafe content
- **Content moderation** — Built-in content filters block prohibited content

Configure guardrails on your agent:

```bash
curl -X POST https://agentc2.ai/agent/api/agents/support-agent/guardrails \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "inputPolicies": [
      {
        "type": "content_filter",
        "action": "block",
        "patterns": ["spam", "abuse"]
      }
    ],
    "outputPolicies": [
      {
        "type": "safety_check",
        "action": "block",
        "categories": ["violence", "hate"]
      }
    ]
  }'
```

### Session Limits

Limit messages per session to prevent abuse:

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "metadata": {
      "publicEmbed": {
        "maxMessagesPerSession": 20
      }
    }
  }'
```

After the limit is reached, users see a message encouraging them to start a new session.

## Monitoring Embed Usage

### View Embed Analytics

Track embed usage and performance:

```bash
curl https://agentc2.ai/agent/api/agents/support-agent/analytics?type=embed \
  -H "Authorization: Bearer $TOKEN"
```

Response includes:

```json
{
    "success": true,
    "analytics": {
        "totalSessions": 1234,
        "totalMessages": 5678,
        "avgMessagesPerSession": 4.6,
        "uniqueVisitors": 890,
        "topOrigins": [
            { "origin": "https://example.com", "sessions": 456 },
            { "origin": "https://www.example.com", "sessions": 234 }
        ],
        "rateLimitHits": 12,
        "blockedRequests": 3
    }
}
```

### Logging and Debugging

Public embed requests are logged with:

- IP address
- User agent
- Origin domain
- Request timestamp
- Response status
- Rate limit status
- Guardrail violations

Access logs via the API:

```bash
curl "https://agentc2.ai/agent/api/agents/support-agent/runs?source=embed&limit=100" \
  -H "Authorization: Bearer $TOKEN"
```

## Public Chat API

Public embeds use a dedicated public chat endpoint that doesn't require authentication:

```bash
curl -X POST https://agentc2.ai/agent/api/agents/support-agent/chat/public \
  -H "Authorization: Bearer pub_xyz789abcdef" \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      { "role": "user", "content": "Hello!" }
    ]
  }'
```

The public endpoint:

- Validates the `publicToken` from the Authorization header
- Applies rate limiting per IP address
- Enforces CORS policies
- Applies guardrails
- Returns streaming responses

<Callout type="warning">
    Public tokens provide unauthenticated access to your agent. Keep tokens secret and rotate them
    regularly. Never commit tokens to version control.
</Callout>

## Best Practices

1. **Use rate limiting** — Prevent abuse with appropriate rate limits (20-50 requests/minute per IP)
2. **Restrict origins** — Use `allowedOrigins` to limit which domains can embed
3. **Rotate tokens regularly** — Generate new tokens periodically for security
4. **Monitor usage** — Track embed analytics to identify abuse patterns
5. **Configure guardrails** — Apply input/output policies to prevent harmful content
6. **Set session limits** — Limit messages per session to prevent resource exhaustion
7. **Customize branding** — Match your website's design with theme and logo customization
8. **Test thoroughly** — Test embeds on different devices and browsers before deploying

## Security Considerations

- **Token secrecy** — Public tokens are still sensitive. Don't expose them in client-side JavaScript if possible
- **HTTPS only** — Always use HTTPS for embed URLs to protect tokens in transit
- **CORS restrictions** — Use `allowedOrigins` to prevent unauthorized embedding
- **Rate limiting** — Set appropriate limits to prevent abuse and control costs
- **Content filtering** — Enable guardrails to prevent harmful content generation
- **Monitoring** — Monitor embed usage for suspicious patterns

## Related Topics

- **[Guardrails](/docs/agents/guardrails)** — Configure input/output policies for safe agent behavior
- **[Embed Channels](/docs/channels/embed)** — Learn about embedding agents in different contexts
- **[Public API Access](/docs/api-reference/public)** — Understand public API authentication and usage
