---
title: "Voice Agents"
description: "Voice agent integration: ElevenLabs live agents, OpenAI Realtime API, call lifecycle, interruption handling, and tool execution."
section: "channels"
order: 5
primaryKeyword: "voice agents"
relatedSlugs: ["channels/overview", "channels/slack", "channels/embed"]
secondaryKeywords: ["ElevenLabs", "OpenAI Realtime", "voice AI", "voice calls", "audio streaming"]
pageType: "how-to"
ctaLabel: "Launch AgentC2 Workspace"
ctaHref: "/workspace"
---

# Voice Agents

AgentC2 supports voice-enabled agents via ElevenLabs live agents and OpenAI Realtime API. Voice agents handle real-time audio conversations with interruption support, tool execution, and human handoff.

## Prerequisites

Before setting up voice agents, ensure you have:

- An ElevenLabs account (for ElevenLabs integration) or OpenAI account (for Realtime API)
- An AgentC2 account with at least one agent created
- A public URL for webhooks (use ngrok for stable URLs)
- ngrok configured for webhook tunneling

## ElevenLabs integration

ElevenLabs provides live conversational AI agents with natural voice interactions.

### Step 1: Create ElevenLabs Agent

1. **Navigate to ElevenLabs**: Go to https://elevenlabs.io
2. **Create Agent**: Go to Agents > Create Agent
3. **Configure Agent**:
    - **Name**: Choose a name (e.g., "AgentC2 Assistant")
    - **Voice**: Select a voice
    - **Instructions**: Enter agent instructions
    - **Webhook URL**: Set to `https://your-domain.com/agent/api/demos/live-agent-mcp/tools`
4. **Save Agent**: Copy the Agent ID

### Step 2: Configure Environment Variables

Add ElevenLabs credentials to your `.env` file:

```bash
# ElevenLabs API
ELEVENLABS_API_KEY="sk_..."
ELEVENLABS_AGENT_ID="agent_..."

# ElevenLabs Webhook (for tool execution)
ELEVENLABS_WEBHOOK_SECRET="wsec_..."
ELEVENLABS_MCP_WEBHOOK_URL="https://your-domain.ngrok-free.dev/agent/api/demos/live-agent-mcp/tools"
```

### Step 3: Configure ngrok

For local development, use ngrok for stable webhook URLs:

```bash
# Start ngrok tunnel
ngrok http 3001 --domain=your-subdomain.ngrok-free.dev

# Or use the provided script
./scripts/start-ngrok.sh
```

Update `ELEVENLABS_MCP_WEBHOOK_URL` with your ngrok URL.

### Step 4: Test Voice Agent

1. **Call Agent**: Use ElevenLabs phone number or web interface
2. **Speak**: Ask a question (e.g., "What is quantum computing?")
3. **Verify Response**: Agent should respond with voice
4. **Test Tools**: Ask agent to use tools (e.g., "Search the web for AI news")

## OpenAI Realtime API

OpenAI Realtime API provides low-latency voice conversations with GPT-4o.

### Step 1: Configure Environment Variables

```bash
# OpenAI API (already configured for agents)
OPENAI_API_KEY="sk-..."

# Realtime API is automatically available when OPENAI_API_KEY is set
```

### Step 2: Initialize Voice Session

```bash
curl -X POST https://agentc2.ai/agent/api/agents/{slug}/voice/start \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "agentSlug": "research-agent",
    "sessionId": "voice-session-123"
  }'
```

### Step 3: Stream Audio

The voice endpoint streams audio responses:

```bash
# WebSocket connection for real-time audio
wss://agentc2.ai/agent/api/agents/{slug}/voice/stream?sessionId=voice-session-123
```

## Call lifecycle

Voice calls follow a predictable lifecycle:

### 1. Call initiation

- **Incoming call**: User calls phone number or initiates web call
- **Agent selection**: System routes to configured agent
- **Session creation**: New conversation session created

### 2. Active conversation

- **Audio streaming**: Real-time bidirectional audio
- **Speech recognition**: User speech converted to text
- **Agent processing**: Agent processes text and generates response
- **Text-to-speech**: Agent response converted to audio
- **Audio playback**: Audio streamed back to user

### 3. Tool execution

- **Tool request**: Agent decides to use a tool
- **Webhook call**: Tool execution request sent to webhook
- **Tool execution**: AgentC2 executes tool (MCP, built-in, etc.)
- **Result return**: Tool result returned to agent
- **Response generation**: Agent incorporates tool result into response

### 4. Call termination

- **User hangup**: User ends call
- **Session cleanup**: Conversation session saved
- **Memory persistence**: Conversation memory persisted for future calls

## Interruption handling

Voice agents support natural interruptions:

### Turn-taking

- **User interruption**: User can interrupt agent mid-response
- **Agent pause**: Agent pauses when user speaks
- **Context maintenance**: Agent maintains context across interruptions

### Implementation

```typescript
// Agent automatically handles interruptions
{
  "interruptionHandling": {
    "enabled": true,
    "pauseOnInterruption": true,
    "resumeAfterInterruption": true
  }
}
```

## Tool execution

Voice agents can execute tools during conversations:

### Webhook endpoint

ElevenLabs calls the webhook when agent requests tool execution:

```
POST /agent/api/demos/live-agent-mcp/tools
```

### Webhook payload

```json
{
    "agent_id": "agent_...",
    "conversation_id": "conv_...",
    "tool_calls": [
        {
            "tool_name": "web-fetch",
            "parameters": {
                "url": "https://example.com"
            }
        }
    ]
}
```

### Tool response

```json
{
    "tool_results": [
        {
            "tool_name": "web-fetch",
            "result": "Web content..."
        }
    ]
}
```

### Available tools

Voice agents have access to all AgentC2 tools:

- **MCP tools**: HubSpot, Jira, Firecrawl, etc.
- **Built-in tools**: Web fetch, calculator, memory recall
- **Custom tools**: Workspace-specific tools

## Human handoff

Voice agents support seamless human handoff:

### Escalation triggers

- **User request**: "I want to speak to a human"
- **Confidence threshold**: Agent confidence below threshold
- **Error handling**: Tool execution failures
- **Timeout**: Long processing times

### Handoff process

1. **Agent detection**: Agent detects need for human handoff
2. **Escalation**: Call routed to human agent
3. **Context transfer**: Conversation context transferred to human
4. **Seamless transition**: User continues conversation with human

### Configuration

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/support-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "metadata": {
      "voice": {
        "humanHandoff": {
          "enabled": true,
          "triggers": ["user_request", "low_confidence"],
          "handoffPhoneNumber": "+1234567890"
        }
      }
    }
  }'
```

## Conversation memory

Voice conversations maintain memory across calls:

- **Call history**: Previous calls with same phone number
- **Semantic recall**: Agents recall relevant past conversations
- **Context persistence**: Conversation context maintained between calls

### Memory configuration

```bash
curl -X PATCH https://agentc2.ai/agent/api/agents/voice-agent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "memoryEnabled": true,
    "memoryConfig": {
      "lastMessages": 30,
      "semanticRecall": {
        "topK": 5,
        "minScore": 0.7
      }
    }
  }'
```

## Audio quality

Voice agents support high-quality audio:

- **Sample rate**: 16kHz or 24kHz
- **Bit depth**: 16-bit
- **Format**: PCM, Opus, MP3
- **Latency**: under 500ms (ElevenLabs), under 300ms (OpenAI Realtime)

## Error handling

Common voice agent errors:

| Error                    | Description                  | Solution                          |
| ------------------------ | ---------------------------- | --------------------------------- |
| **Audio codec mismatch** | Unsupported audio format     | Use supported formats (PCM, Opus) |
| **Webhook timeout**      | Tool execution timeout       | Optimize tool execution time      |
| **Network issues**       | Audio streaming interruption | Check network connectivity        |
| **Agent not found**      | Agent slug invalid           | Verify agent exists               |

## Troubleshooting

### No audio response

1. **Check agent configuration**: Verify agent is configured correctly
2. **Review webhook**: Ensure webhook URL is accessible
3. **Test audio**: Check audio encoding/decoding

### Tool execution failing

1. **Verify webhook**: Check webhook endpoint is receiving requests
2. **Review logs**: Check AgentC2 logs for tool execution errors
3. **Test tools**: Verify tools work via API

### High latency

1. **Optimize tools**: Reduce tool execution time
2. **Check network**: Verify network latency
3. **Use caching**: Cache tool results when possible

## Next steps

- **[Channels Overview](/docs/channels/overview)** — Learn about other supported channels
- **[Web Embed](/docs/channels/embed)** — Embed chat widget in your website
- **[Agents Overview](/docs/agents/overview)** — Learn about agent capabilities
