---
title: "Triggers and Schedules"
description: "Trigger types (scheduled, webhook, event, mcp, api, manual, test), unified trigger shape, AgentTrigger/AgentSchedule models, creating triggers via API, cron expressions, webhook validation."
section: "platform"
order: 6
primaryKeyword: "triggers and schedules"
relatedSlugs: ["platform/background-jobs", "agents/overview", "integrations/overview"]
pageType: "how-to"
ctaLabel: "Launch AgentC2 Workspace"
ctaHref: "/workspace"
---

# Triggers and Schedules

AgentC2 supports multiple trigger types for invoking agents: scheduled (cron), webhooks, events, MCP signals, API calls, manual execution, and test runs. All triggers follow a unified shape and are managed via `AgentTrigger` and `AgentSchedule` models, enabling flexible automation patterns.

## Trigger types

The platform supports seven trigger types, each optimized for different use cases:

| Trigger Type  | Description                     | Use Case                                |
| ------------- | ------------------------------- | --------------------------------------- |
| **scheduled** | Cron-based recurring execution  | Daily reports, periodic checks          |
| **webhook**   | HTTP POST to unique webhook URL | External system integrations            |
| **event**     | Internal event bus (Inngest)    | Cross-agent workflows, learning signals |
| **mcp**       | MCP server tool signals         | Tool-triggered agent invocations        |
| **api**       | Direct API calls                | Programmatic invocations                |
| **manual**    | User-initiated from UI          | Testing, one-off runs                   |
| **test**      | Test execution mode             | Development, validation                 |

### Unified trigger shape

All triggers share a common structure:

```typescript
interface TriggerPayload {
    triggerType: "scheduled" | "webhook" | "event" | "mcp" | "api" | "manual" | "test";
    agentId: string;
    workspaceId?: string;
    input?: {
        messages?: Array<{ role: string; content: string }>;
        [key: string]: unknown;
    };
    metadata?: {
        triggerId?: string;
        scheduleId?: string;
        webhookPath?: string;
        eventName?: string;
        [key: string]: unknown;
    };
}
```

## Scheduled triggers

Scheduled triggers use cron expressions for recurring execution:

### AgentSchedule model

```typescript
// Database model: AgentSchedule
{
  id: "schedule_123",
  agentId: "agent_456",
  workspaceId: "ws_789",
  name: "Daily Report",
  description: "Generate daily summary report",
  cronExpr: "0 17 * * FRI", // Every Friday at 5 PM
  timezone: "America/New_York",
  inputJson: {
    messages: [
      { "role": "user", "content": "Generate today's summary report" }
    ]
  },
  isActive: true,
  lastRunAt: "2026-02-17T17:00:00Z",
  nextRunAt: "2026-02-24T17:00:00Z",
  runCount: 52
}
```

### Cron expression syntax

Cron expressions use standard 5-field format:

```
┌───────────── minute (0 - 59)
│ ┌───────────── hour (0 - 23)
│ │ ┌───────────── day of month (1 - 31)
│ │ │ ┌───────────── month (1 - 12)
│ │ │ │ ┌───────────── day of week (0 - 6) (Sunday to Saturday)
│ │ │ │ │
* * * * *
```

### Common cron patterns

| Pattern          | Expression     | Description                              |
| ---------------- | -------------- | ---------------------------------------- |
| Every minute     | `* * * * *`    | Run every minute                         |
| Every hour       | `0 * * * *`    | Run at minute 0 of every hour            |
| Daily at 9 AM    | `0 9 * * *`    | Run at 9:00 AM every day                 |
| Weekly on Monday | `0 9 * * 1`    | Run at 9:00 AM every Monday              |
| Monthly on 1st   | `0 9 1 * *`    | Run at 9:00 AM on the 1st of every month |
| Every weekday    | `0 9 * * 1-5`  | Run at 9:00 AM Monday-Friday             |
| Every 15 minutes | `*/15 * * * *` | Run every 15 minutes                     |

### Creating schedules

```bash
# Create a scheduled trigger
curl -X POST https://agentc2.ai/agent/api/agents/research-assistant/schedules \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Daily Research Summary",
    "description": "Generate daily research summary every morning",
    "cronExpr": "0 9 * * *",
    "timezone": "UTC",
    "inputJson": {
      "messages": [
        { "role": "user", "content": "Generate today's research summary" }
      ]
    }
  }'
```

### Schedule execution

Schedules are executed by a background cron job that:

1. **Finds due schedules** — Queries `AgentSchedule` where `nextRunAt` is at or before `NOW()` and `isActive = true`
2. **Invokes agent** — Calls agent with `inputJson` payload
3. **Updates schedule** — Sets `lastRunAt` and calculates `nextRunAt`
4. **Increments counter** — Updates `runCount`

<Callout type="tip">
    **Timezone handling**: Always specify `timezone` when creating schedules. Cron expressions are
    evaluated in the specified timezone, not UTC.
</Callout>

## Webhook triggers

Webhook triggers expose unique HTTP endpoints for external systems:

### AgentTrigger model (webhook)

```typescript
// Database model: AgentTrigger (webhook type)
{
  id: "trigger_123",
  agentId: "agent_456",
  workspaceId: "ws_789",
  name: "Slack Webhook",
  description: "Trigger agent from Slack",
  triggerType: "webhook",
  webhookPath: "slack-research-assistant", // Unique path
  webhookSecret: "wsec_abc123", // For validation
  filterJson: {
    // Optional: filter by payload fields
    "event.type": "message"
  },
  inputMapping: {
    // Map webhook payload to agent input
    "messages": [
      {
        "role": "user",
        "content": "{{payload.event.text}}"
      }
    ]
  },
  isActive: true,
  lastTriggeredAt: "2026-02-18T12:00:00Z",
  triggerCount: 42
}
```

### Webhook URL structure

Webhooks are accessible at:

```
POST https://agentc2.ai/agent/api/webhooks/{webhookPath}
```

Example:

```bash
# Trigger agent via webhook
curl -X POST https://agentc2.ai/agent/api/webhooks/slack-research-assistant \
  -H "Content-Type: application/json" \
  -H "X-Webhook-Secret: wsec_abc123" \
  -d '{
    "event": {
      "type": "message",
      "text": "What are the latest AI trends?",
      "user": "user_123"
    }
  }'
```

### Webhook validation

Webhooks validate the `X-Webhook-Secret` header:

```typescript
// Validate webhook secret
const webhookSecret = request.headers.get("X-Webhook-Secret");
const trigger = await prisma.agentTrigger.findUnique({
    where: { webhookPath }
});

if (trigger.webhookSecret !== webhookSecret) {
    return NextResponse.json({ error: "Invalid webhook secret" }, { status: 401 });
}
```

### Input mapping

Webhook payloads are mapped to agent input via `inputMapping`:

```json
{
    "inputMapping": {
        "messages": [
            {
                "role": "user",
                "content": "{{payload.event.text}}"
            }
        ],
        "metadata": {
            "source": "slack",
            "userId": "{{payload.event.user}}",
            "channel": "{{payload.event.channel}}"
        }
    }
}
```

Template variables use `{{payload.path}}` syntax to extract values from the webhook payload.

<Callout type="warning">
    **Webhook security**: Always use `webhookSecret` for webhook validation. Without validation,
    anyone with the webhook URL can trigger your agent.
</Callout>

## Event triggers

Event triggers listen to internal Inngest events:

### Event trigger configuration

```typescript
{
  id: "trigger_456",
  agentId: "agent_789",
  triggerType: "event",
  eventName: "run/completed", // Inngest event name
  filterJson: {
    // Optional: filter by event data
    "data.agentId": "agent_123",
    "data.status": "COMPLETED"
  },
  inputMapping: {
    "messages": [
      {
        "role": "user",
        "content": "Analyze the completed run: {{data.runId}}"
      }
    ]
  }
}
```

### Publishing events

Events are published via Inngest:

```typescript
import { inngest } from "@/lib/inngest";

// Publish event that triggers agent
await inngest.send({
    name: "run/completed",
    data: {
        runId: "run_123",
        agentId: "agent_456",
        status: "COMPLETED"
    }
});
```

### Event processing

The platform processes events via Inngest functions:

```typescript
// Inngest function: agentTriggerFireFunction
export const agentTriggerFireFunction = inngest.createFunction(
    { id: "agent-trigger-fire" },
    { event: "run/completed" },
    async ({ event }) => {
        // Find matching triggers
        const triggers = await prisma.agentTrigger.findMany({
            where: {
                triggerType: "event",
                eventName: event.name,
                isActive: true
            }
        });

        // Filter by filterJson
        const matchingTriggers = triggers.filter((trigger) => {
            return matchesFilter(event.data, trigger.filterJson);
        });

        // Invoke agents
        for (const trigger of matchingTriggers) {
            await invokeAgent(trigger.agentId, trigger.inputMapping);
        }
    }
);
```

## MCP triggers

MCP triggers respond to MCP server tool signals:

### MCP trigger configuration

```typescript
{
  id: "trigger_789",
  agentId: "agent_123",
  triggerType: "mcp",
  eventName: "mcp:hubspot:contact.created", // MCP event pattern
  filterJson: {
    "mcpServer": "hubspot",
    "tool": "create-contact"
  },
  inputMapping: {
    "messages": [
      {
        "role": "user",
        "content": "New contact created: {{data.contact.name}}"
      }
    ]
  }
}
```

### MCP event flow

1. **MCP tool execution** — Tool executes and emits event
2. **Event capture** — Platform captures MCP event
3. **Trigger matching** — Find triggers matching `eventName` and `filterJson`
4. **Agent invocation** — Invoke agent with mapped input

## API triggers

API triggers are direct programmatic invocations:

### Invoking via API

```bash
# Direct API invocation
curl -X POST https://agentc2.ai/agent/api/agents/research-assistant/invoke \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "input": {
      "messages": [
        { "role": "user", "content": "Research quantum computing" }
      ]
    }
  }'
```

API triggers don't require `AgentTrigger` records — they're direct invocations.

## Manual and test triggers

### Manual triggers

Manual triggers are initiated from the workspace UI:

- **One-off execution** — Run agent with custom input
- **Testing** — Validate agent behavior
- **Debugging** — Test specific scenarios

### Test triggers

Test triggers run in a special test mode:

- **No persistence** — Traces not saved to database
- **No side effects** — Tool calls are mocked
- **Fast iteration** — Quick feedback for development

## Duplicate handling

The platform prevents duplicate trigger executions:

### Deduplication strategies

| Trigger Type  | Deduplication Method                     |
| ------------- | ---------------------------------------- |
| **scheduled** | Skip if `lastRunAt` within cron interval |
| **webhook**   | Idempotency key in request header        |
| **event**     | Inngest event ID deduplication           |
| **mcp**       | MCP event ID deduplication               |
| **api**       | Request ID deduplication                 |

### Idempotency keys

Webhooks and API calls support idempotency:

```bash
# Include idempotency key
curl -X POST https://agentc2.ai/agent/api/webhooks/slack-research-assistant \
  -H "X-Idempotency-Key: unique-request-id-123" \
  -d '{ ... }'
```

Duplicate requests with the same idempotency key return the same result without re-execution.

## Creating triggers

### Via API

```bash
# Create webhook trigger
curl -X POST https://agentc2.ai/agent/api/agents/research-assistant/triggers \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Slack Integration",
    "triggerType": "webhook",
    "webhookPath": "slack-research",
    "webhookSecret": "wsec_abc123",
    "inputMapping": {
      "messages": [
        {
          "role": "user",
          "content": "{{payload.text}}"
        }
      ]
    }
  }'
```

### Via UI

Triggers can be created in the workspace UI:

1. Navigate to agent settings
2. Open "Triggers" tab
3. Click "Create Trigger"
4. Select trigger type
5. Configure settings
6. Save trigger

## Best practices

1. **Use appropriate trigger types** — Scheduled for recurring, webhooks for external systems
2. **Set webhook secrets** — Always validate webhook requests
3. **Map inputs correctly** — Use `inputMapping` to transform payloads
4. **Filter events** — Use `filterJson` to avoid unnecessary invocations
5. **Monitor trigger counts** — Track `triggerCount` for usage analytics
6. **Handle duplicates** — Use idempotency keys for webhooks/API
7. **Test triggers** — Use test mode for development

## Related topics

- **[Background Jobs](/docs/platform/background-jobs)** — How scheduled triggers execute
- **[Agents Overview](/docs/agents/overview)** — Agent invocation patterns
- **[Integrations Overview](/docs/integrations/overview)** — External system integrations
