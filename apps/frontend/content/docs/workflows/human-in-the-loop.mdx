---
title: "Human in the Loop"
description: "Add human approval gates, suspend and resume workflows, configure timeout policies, and handle non-response scenarios."
section: "workflows"
order: 5
primaryKeyword: "human in the loop workflows"
secondaryKeywords: ["approval gates", "suspend resume", "human approval", "workflow suspension"]
relatedSlugs: ["workflows/overview", "workflows/step-types", "workflows/control-flow"]
pageType: "how-to"
---

# Human in the Loop

Human-in-the-loop workflows enable human oversight, approval, and decision-making in automated processes. Workflows can suspend execution, wait for human input, and resume based on approval or rejection.

## Approval gates

Use `human` step type to create approval gates.

### Basic approval

```json
{
    "id": "approval",
    "type": "human",
    "name": "Content Approval",
    "config": {
        "prompt": "Please review and approve this content: {{generate.output.content}}",
        "formSchema": {
            "type": "object",
            "properties": {
                "approved": {
                    "type": "boolean",
                    "description": "Approve this content?"
                }
            },
            "required": ["approved"]
        }
    }
}
```

**Execution flow:**

1. Workflow executes up to `approval` step
2. Workflow **suspends** and creates approval request
3. Human reviews content and submits form
4. Workflow **resumes** with approval data
5. Subsequent steps execute based on approval

### Approval request

When workflow suspends, an `ApprovalRequest` record is created:

```json
{
  "id": "ar_abc123",
  "workflowRunId": "wr_xyz789",
  "stepId": "approval",
  "prompt": "Please review and approve this content...",
  "formSchema": {...},
  "status": "PENDING",
  "createdAt": "2026-02-18T12:00:00.000Z"
}
```

## Suspend and resume

Workflows suspend at `human` steps and resume when approval is submitted.

### Suspension

When workflow reaches a `human` step:

1. **Workflow suspends** — Execution pauses
2. **Approval request created** — `ApprovalRequest` record in database
3. **Notification sent** — Human receives notification (email, Slack, etc.)
4. **Workflow run status** — Set to `SUSPENDED`

### Resume

Resume workflow by submitting approval:

```bash
curl -X POST https://agentc2.ai/agent/api/workflows/support-triage/runs/wr_xyz789/resume \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "resumeData": {
      "approved": true,
      "comments": "Looks good!"
    }
  }'
```

**Resume flow:**

1. Approval submitted via API or UI
2. Workflow run status → `RUNNING`
3. `human` step completes with approval data
4. Subsequent steps execute

### Resume data format

Resume data must match `formSchema`:

```json
{
    "resumeData": {
        "approved": true,
        "comments": "Optional comments"
    }
}
```

## Timeout policies

Configure timeouts for approval gates.

### Step-level timeout

```json
{
    "id": "approval",
    "type": "human",
    "config": {
        "prompt": "Please approve...",
        "timeout": 3600
    }
}
```

**Timeout behavior:**

- If timeout expires → Workflow fails with timeout error
- Default: No timeout (waits indefinitely)

### Workflow-level timeout

```json
{
    "timeout": 7200
}
```

Workflow fails if total execution (including suspension time) exceeds timeout.

### Timeout handling

When timeout expires:

1. **Approval request** → Status set to `TIMEOUT`
2. **Workflow run** → Status set to `FAILED`
3. **Error output** → Includes timeout details

```json
{
    "success": false,
    "error": "Approval timeout: No response within 3600 seconds",
    "failedStep": "approval",
    "timeoutAt": "2026-02-18T13:00:00.000Z"
}
```

## Escalation routing

Route approvals to different humans based on conditions.

### Conditional routing

```json
{
  "steps": [
    {
      "id": "analyze",
      "type": "agent",
      "config": { "agentSlug": "analyzer" }
    },
    {
      "id": "route-approval",
      "type": "branch",
      "config": {
        "condition": "{{analyze.output.amount}}",
        "branches": [
          {
            "condition": "> 10000",
            "steps": [
              {
                "id": "manager-approval",
                "type": "human",
                "config": {
                  "prompt": "Manager approval required for amount > $10,000",
                  "formSchema": {...},
                  "assignee": "manager@example.com"
                }
              }
            ]
          },
          {
            "condition": "default",
            "steps": [
              {
                "id": "standard-approval",
                "type": "human",
                "config": {
                  "prompt": "Standard approval required",
                  "formSchema": {...}
                }
              }
            ]
          }
        ]
      }
    }
  ]
}
```

### Assignee configuration

Assign approvals to specific users:

```json
{
    "config": {
        "prompt": "Please approve...",
        "assignee": "user@example.com",
        "assigneeGroup": "managers"
    }
}
```

## Notification channels

Configure how humans are notified of approval requests.

### Email notifications

```json
{
    "config": {
        "prompt": "Please approve...",
        "notifications": {
            "email": {
                "enabled": true,
                "template": "approval-request"
            }
        }
    }
}
```

### Slack notifications

```json
{
    "config": {
        "prompt": "Please approve...",
        "notifications": {
            "slack": {
                "enabled": true,
                "channel": "#approvals"
            }
        }
    }
}
```

### Custom notifications

Use tools to send custom notifications:

```json
{
  "steps": [
    {
      "id": "notify",
      "type": "tool",
      "config": {
        "toolId": "send-slack-message",
        "inputMapping": {
          "channel": "#approvals",
          "message": "Approval required: {{input.requestId}}"
        }
      }
    },
    {
      "id": "approval",
      "type": "human",
      "config": {...}
    }
  ]
}
```

## Non-response behavior

Configure behavior when humans don't respond.

### Default behavior

- **No timeout** → Workflow waits indefinitely
- **With timeout** → Workflow fails on timeout

### Escalation

Escalate to another approver after timeout:

```json
{
    "steps": [
        {
            "id": "approval",
            "type": "human",
            "config": {
                "prompt": "Please approve...",
                "timeout": 3600,
                "escalation": {
                    "enabled": true,
                    "timeout": 3600,
                    "escalateTo": "manager@example.com"
                }
            }
        }
    ]
}
```

### Auto-approval

Auto-approve after timeout (use with caution):

```json
{
    "config": {
        "prompt": "Please approve...",
        "timeout": 3600,
        "autoApprove": {
            "enabled": true,
            "afterTimeout": true,
            "defaultValue": true
        }
    }
}
```

## Approval form schemas

Define approval forms using JSON Schema.

### Simple boolean

```json
{
    "formSchema": {
        "type": "object",
        "properties": {
            "approved": {
                "type": "boolean",
                "description": "Approve this request?"
            }
        },
        "required": ["approved"]
    }
}
```

### Complex form

```json
{
    "formSchema": {
        "type": "object",
        "properties": {
            "approved": {
                "type": "boolean",
                "description": "Approve this request?"
            },
            "comments": {
                "type": "string",
                "description": "Optional comments",
                "maxLength": 500
            },
            "priority": {
                "type": "string",
                "enum": ["low", "medium", "high"],
                "description": "Priority level"
            }
        },
        "required": ["approved"]
    }
}
```

## Example: Content publishing workflow

Complete workflow with approval gate:

```json
{
    "steps": [
        {
            "id": "generate",
            "type": "agent",
            "name": "Generate Content",
            "config": {
                "agentSlug": "content-generator",
                "inputMapping": {
                    "messages": [
                        {
                            "role": "user",
                            "content": "Generate blog post about: {{input.topic}}"
                        }
                    ]
                }
            }
        },
        {
            "id": "approval",
            "type": "human",
            "name": "Human Approval",
            "config": {
                "prompt": "Please review and approve this content:\n\n{{generate.output.content}}",
                "formSchema": {
                    "type": "object",
                    "properties": {
                        "approved": {
                            "type": "boolean",
                            "description": "Approve this content for publishing?"
                        },
                        "comments": {
                            "type": "string",
                            "description": "Optional feedback or edits"
                        }
                    },
                    "required": ["approved"]
                },
                "timeout": 3600
            }
        },
        {
            "id": "publish",
            "type": "branch",
            "name": "Publish or Reject",
            "config": {
                "condition": "{{approval.output.approved}}",
                "branches": [
                    {
                        "condition": true,
                        "steps": [
                            {
                                "id": "publish-content",
                                "type": "tool",
                                "config": {
                                    "toolId": "publish-blog-post",
                                    "inputMapping": {
                                        "content": "{{generate.output.content}}",
                                        "comments": "{{approval.output.comments}}"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "condition": "default",
                        "steps": [
                            {
                                "id": "notify-rejection",
                                "type": "tool",
                                "config": {
                                    "toolId": "send-notification",
                                    "inputMapping": {
                                        "message": "Content rejected: {{approval.output.comments}}"
                                    }
                                }
                            }
                        ]
                    }
                ]
            }
        }
    ]
}
```

## Best practices

1. **Set timeouts** — Prevent workflows from waiting indefinitely
2. **Use clear prompts** — Provide context and instructions
3. **Define form schemas** — Structure approval data
4. **Handle rejection** — Branch based on approval status
5. **Configure notifications** — Ensure humans are notified
6. **Escalate when needed** — Route to managers for high-value approvals

## Next steps

- **[Step Types](/docs/workflows/step-types)** — Learn about the `human` step type
- **[Control Flow](/docs/workflows/control-flow)** — Understand branching and conditional logic
- **[Workflows API Reference](/docs/workflows/api-reference)** — API documentation for suspend/resume
