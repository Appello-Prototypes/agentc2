---
title: "Slack"
description: "Connect agents to Slack for team messaging, channel conversations, and direct message support via MCP tools and webhooks."
section: "integrations"
order: 5
primaryKeyword: "Slack integration"
relatedSlugs: ["integrations/overview", "integrations/model-context-protocol", "agents/tools"]
pageType: "how-to"
ctaLabel: "Explore Integrations in AgentC2"
ctaHref: "/workspace"
---

# Slack

Slack integration enables two-way conversations between agents and Slack users. Agents can read messages, send replies, search channels, and manage users—all while maintaining separate conversation threads per Slack thread. The integration combines MCP tools for API operations with webhook handlers for real-time event processing.

## Overview

The Slack integration provides both tool-based access (via MCP) and channel-native messaging (via webhooks). Agents can be @mentioned in channels or receive direct messages, respond in threads, and use Slack's API to search channels, list users, and post messages with custom formatting.

<Callout type="info">
    Slack integration uses OAuth2 for multi-tenant support. One Slack App can be installed across
    multiple customer workspaces, with per-workspace bot tokens stored in `IntegrationConnection`.
</Callout>

## Prerequisites

- Slack workspace admin access
- Slack App created at [api.slack.com/apps](https://api.slack.com/apps)
- OAuth redirect URL configured
- Webhook URL for event subscriptions (requires public HTTPS endpoint)

## Setup

### Step 1: Create Slack App

1. Go to [api.slack.com/apps](https://api.slack.com/apps) and click **Create New App** > **From scratch**
2. Name your app (e.g., "AgentC2 Assistant") and select your workspace
3. Note your **App ID** and **Client ID** (from **Basic Information**)

### Step 2: Configure Bot Permissions

Navigate to **OAuth & Permissions** and add Bot Token Scopes:

**Required scopes:**

- `app_mentions:read` - Receive @mentions
- `chat:write` - Send messages
- `chat:write.customize` - Post with custom username/icon per agent
- `im:history` - Read DM history
- `im:read` - Access DM metadata
- `im:write` - Send DMs
- `channels:history` - Read channel messages (for @mentions)
- `channels:read` - Access channel metadata
- `users:read` - Read user information
- `users:read.email` - Read user email addresses

**Optional scopes:**

- `files:read` - Read file attachments
- `reactions:write` - Add emoji reactions
- `search:read` - Search messages and files

### Step 3: Enable Event Subscriptions

1. Navigate to **Event Subscriptions** and turn on **Enable Events**
2. Set Request URL to: `https://your-domain/agent/api/slack/events`
3. Subscribe to bot events:
    - `app_mention` - When bot is @mentioned in a channel
    - `message.im` - Direct messages to bot
4. Save changes

<Callout type="warning">
    For local development, use ngrok or similar to expose `localhost:3001` as a public HTTPS URL.
    Set `NGROK_DOMAIN` in `.env` for stable URLs.
</Callout>

### Step 4: Install App to Workspace

1. Navigate to **Install App** and click **Install to Workspace**
2. Authorize the app and copy:
    - **Bot User OAuth Token** (starts with `xoxb-`)
    - **Signing Secret** (from **Basic Information** > **App Credentials**)

### Step 5: Configure in AgentC2

**Via UI:**

1. Navigate to **Settings > Integrations**
2. Find **Slack** and click **Connect**
3. Enter:
    - **Client ID**: From Slack App settings
    - **Client Secret**: From Slack App settings
    - **Signing Secret**: From Slack App settings
    - **Bot Token**: Bot User OAuth Token (`xoxb-...`)
    - **Team ID**: Workspace ID (starts with `T`)
4. Click **Test Connection** to verify
5. Tools and webhooks are automatically configured

**Via API:**

```bash
curl -X POST https://agentc2.ai/agent/api/integrations/connections \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "providerKey": "slack",
    "name": "Production Slack",
    "credentials": {
      "SLACK_CLIENT_ID": "...",
      "SLACK_CLIENT_SECRET": "...",
      "SLACK_SIGNING_SECRET": "...",
      "SLACK_BOT_TOKEN": "xoxb-...",
      "SLACK_TEAM_ID": "T01234567"
    }
  }'
```

### Step 6: Configure default agent

Set which agent handles Slack messages:

```bash
# Via environment variable (legacy)
SLACK_DEFAULT_AGENT_SLUG="assistant"

# Or per-connection metadata
{
  "metadata": {
    "defaultAgentSlug": "assistant"
  }
}
```

## Environment variables

| Variable                   | Required | Description                                                    |
| -------------------------- | -------- | -------------------------------------------------------------- |
| `SLACK_CLIENT_ID`          | Yes      | Slack App OAuth client ID (platform-level)                     |
| `SLACK_CLIENT_SECRET`      | Yes      | Slack App OAuth client secret (platform-level)                 |
| `SLACK_SIGNING_SECRET`     | Yes      | Per-app signing secret for webhook verification                |
| `SLACK_BOT_TOKEN`          | Yes\*    | Bot User OAuth Token (`xoxb-...`) - legacy fallback            |
| `SLACK_TEAM_ID`            | Yes\*    | Workspace ID (`T...`) - legacy fallback                        |
| `SLACK_DEFAULT_AGENT_SLUG` | No       | Default agent for Slack conversations (default: `"assistant"`) |

\* Required for legacy MCP server fallback. New OAuth-based connections store tokens in `IntegrationConnection.credentials`.

## Available tools

| Tool Name                     | Description                       |
| ----------------------------- | --------------------------------- |
| `slack_slack-send-message`    | Send a message to a channel or DM |
| `slack_slack-list-channels`   | List all channels in workspace    |
| `slack_slack-get-channel`     | Get channel details by ID         |
| `slack_slack-search-messages` | Search messages across channels   |
| `slack_slack-get-user`        | Get user details by ID            |
| `slack_slack-list-users`      | List all users in workspace       |

Tool names follow the pattern `slack_{tool-name}`. Use the tools API to see the full list with parameter schemas.

## Common patterns

### Send message to channel

```typescript
// Agent receives: "Post 'Meeting at 3pm' to #general"
// Agent calls:
{
  tool: "slack_slack-send-message",
  arguments: {
    channel: "C01234567", // Channel ID
    text: "Meeting at 3pm",
    threadTs: null // New thread
  }
}
```

### Reply in thread

```typescript
// Agent receives: "@bot What's the status?" (in thread)
// Agent processes message, then replies:
{
  tool: "slack_slack-send-message",
  arguments: {
    channel: "C01234567",
    text: "Status: All systems operational.",
    threadTs: "1234567890.123456" // Reply to existing thread
  }
}
```

### Search messages

```typescript
// Agent receives: "Find messages about 'deployment'"
// Agent calls:
{
  tool: "slack_slack-search-messages",
  arguments: {
    query: "deployment",
    count: 10
  }
}
```

### Get user information

```typescript
// Agent receives: "Who is @john?"
// Agent calls:
{
  tool: "slack_slack-get-user",
  arguments: {
    user: "U01234567" // User ID from @mention
  }
}
// Returns: { name: "John Doe", email: "john@example.com", ... }
```

## Agent routing

Agents can be routed per message using the `agent:` prefix:

```
@Bot agent:research What is quantum computing?
```

Supported commands:

- `agent:<slug>` - Route to specific agent (e.g., `agent:sales-assistant`)
- `agent:list` - List all available agents with slugs
- `help` - Show usage instructions

If no `agent:` prefix is provided, the default agent (`SLACK_DEFAULT_AGENT_SLUG` or connection metadata) handles the message.

## Per-agent display identity

Each agent can have custom Slack display name and icon. Set in agent `metadata`:

```json
{
    "slack": {
        "displayName": "Research Agent",
        "iconEmoji": ":microscope:"
    }
}
```

When posting messages, the agent uses its custom identity:

```typescript
{
  tool: "slack_slack-send-message",
  arguments: {
    channel: "C01234567",
    text: "Message text",
    username: "Research Agent", // From metadata
    iconEmoji: ":microscope:" // From metadata
  }
}
```

If no `slack` metadata is set, the agent's `name` field is used as the display name.

## Conversation threading

Slack conversations maintain separate threads per Slack thread:

- **Channel @mentions**: Each thread maintains its own conversation context
- **Direct messages**: Each DM thread is a separate conversation
- **Thread replies**: Replies in threads maintain parent thread context

Conversation IDs are derived from Slack thread timestamps (`thread_ts`):

```typescript
// Conversation ID format: slack-{teamId}-{channelId}-{threadTs}
const conversationId = `slack-${teamId}-${channelId}-${threadTs}`;
```

This ensures each Slack thread has isolated conversation memory.

## Troubleshooting

| Problem                           | Solution                                                                                                   |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| **"Webhook verification failed"** | Verify `SLACK_SIGNING_SECRET` matches Slack App settings. Check webhook URL is accessible via HTTPS.       |
| **"Bot not responding"**          | Ensure bot is added to channel (`/invite @BotName`). Check `app_mention` event is subscribed.              |
| **"Permission denied"**           | Verify bot has required scopes (`chat:write`, `channels:read`, etc.). Reinstall app if scopes changed.     |
| **"Invalid token"**               | Bot token may be revoked. Regenerate in Slack App settings and update `IntegrationConnection.credentials`. |
| **"Channel not found"**           | Bot must be added to private channels. Use `channels:read` scope and verify bot membership.                |
| **"Message not delivered"**       | Check Slack API rate limits. Implement retry logic with exponential backoff.                               |

## Webhook event handling

Slack sends events to `/agent/api/slack/events`:

### Event types

**`app_mention`:**

```json
{
    "type": "app_mention",
    "user": "U01234567",
    "text": "<@U0BOT123> agent:research What is AI?",
    "ts": "1234567890.123456",
    "channel": "C01234567",
    "thread_ts": "1234567890.123456" // If in thread
}
```

**`message.im`:**

```json
{
    "type": "message",
    "subtype": null,
    "user": "U01234567",
    "text": "Hello",
    "ts": "1234567890.123456",
    "channel": "D01234567" // DM channel
}
```

### Event processing flow

1. **Receive event** - Webhook handler validates signature
2. **Extract message** - Parse user, text, channel, thread
3. **Route to agent** - Determine agent slug (`agent:` prefix or default)
4. **Process message** - Agent generates response
5. **Send reply** - Post response to Slack (same thread if `thread_ts` present)

## Best practices

### 1. Use threads for context

Always reply in threads to maintain conversation context:

```typescript
// Check if message is in thread
if (event.thread_ts) {
    // Reply in thread
    await sendMessage({
        channel: event.channel,
        text: response,
        threadTs: event.thread_ts
    });
} else {
    // Start new thread
    await sendMessage({
        channel: event.channel,
        text: response,
        threadTs: event.ts // Use message timestamp as thread root
    });
}
```

### 2. Handle rate limits

Slack API has rate limits (Tier 2: 20 requests/minute). Implement retry logic:

```typescript
async function sendWithRetry(message, retries = 3) {
    try {
        return await slackSendMessage(message);
    } catch (error) {
        if (error.rateLimited && retries > 0) {
            await sleep(error.retryAfter * 1000);
            return sendWithRetry(message, retries - 1);
        }
        throw error;
    }
}
```

### 3. Validate user input

Sanitize user messages before processing:

```typescript
// Remove @mentions and formatting
const cleanText = text
    .replace(/<@[^>]+>/g, "") // Remove @mentions
    .replace(/<[^>]+>/g, "") // Remove links/formatting
    .trim();
```

## Related topics

- **[Integrations Overview](/docs/integrations/overview)** — Learn about integration architecture
- **[Model Context Protocol](/docs/integrations/model-context-protocol)** — Understand MCP tool execution
- **[Agent Tools](/docs/agents/tools)** — Attach tools to agents
