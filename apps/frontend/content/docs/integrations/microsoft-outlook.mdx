---
title: "Microsoft Outlook"
description: "Connect agents to Microsoft Outlook for email and calendar management via Microsoft Graph API and Azure AD OAuth2."
section: "integrations"
order: 10
primaryKeyword: "Microsoft Outlook integration"
relatedSlugs: ["integrations/overview", "integrations/microsoft-teams", "agents/tools"]
pageType: "how-to"
ctaLabel: "Explore Integrations in AgentC2"
ctaHref: "/workspace"
---

# Microsoft Outlook

Microsoft Outlook integration enables agents to read emails, send messages, manage calendar events, and handle scheduling conflicts using Microsoft Graph API and Azure AD OAuth2 authentication. The integration provides both Mail and Calendar capabilities through a single OAuth connection.

## Overview

The Microsoft Outlook integration exposes email and calendar operations as OAuth-native tools that agents can call during conversations. Agents can search inboxes, send emails, list calendar events, create meetings, and detect scheduling conflicts—all while respecting Microsoft 365 permissions and organizational policies.

<Callout type="info">
    Microsoft Outlook integration uses Azure AD OAuth2 with Microsoft Graph API. One OAuth
    connection enables both Mail and Calendar tools—no separate connections needed.
</Callout>

## Prerequisites

- Microsoft 365 account (personal or organizational)
- Azure AD app registration
- OAuth2 client ID and secret
- Required API permissions configured

## Setup

### Step 1: Register Azure AD application

1. Go to [Azure Portal](https://portal.azure.com) > **Azure Active Directory** > **App registrations**
2. Click **New registration**
3. Name: "AgentC2 Integration"
4. Supported account types:
    - **Accounts in any organizational directory and personal Microsoft accounts** (multi-tenant)
    - Or **Single tenant** for organization-only access
5. Redirect URI: `https://your-domain/api/integrations/microsoft/callback`
6. Click **Register**
7. Note **Application (client) ID** and **Directory (tenant) ID**

### Step 2: Create client secret

1. In app registration, go to **Certificates & secrets**
2. Click **New client secret**
3. Description: "AgentC2 Integration Secret"
4. Expires: 24 months (or custom)
5. Click **Add** and copy the secret value immediately

### Step 3: Configure API permissions

1. Go to **API permissions**
2. Click **Add a permission** > **Microsoft Graph** > **Delegated permissions**
3. Add permissions:
    - `Mail.Read` - Read mail
    - `Mail.ReadWrite` - Read and write mail
    - `Mail.Send` - Send mail
    - `Calendars.Read` - Read calendars
    - `Calendars.ReadWrite` - Read and write calendars
    - `offline_access` - Refresh tokens
    - `User.Read` - Read user profile
4. Click **Add permissions**
5. For organizational tenants, click **Grant admin consent** (if required)

<Callout type="warning">
    Enterprise organizations may require admin consent for `Mail.ReadWrite` and
    `Calendars.ReadWrite`. Users will see an admin consent prompt during OAuth flow if needed.
</Callout>

### Step 4: Configure in AgentC2

**Environment variables:**

```bash
MICROSOFT_CLIENT_ID="your-client-id"
MICROSOFT_CLIENT_SECRET="your-client-secret"
MICROSOFT_TENANT_ID="common" # or specific tenant ID
CREDENTIAL_ENCRYPTION_KEY="..." # Same as other OAuth integrations
```

**Via UI:**

1. Navigate to **Settings > Integrations**
2. Find **Microsoft (Outlook)** and click **Connect**
3. Click **Connect via Microsoft Sign-In**
4. Authorize AgentC2 to access Mail and Calendar
5. Tokens are automatically stored encrypted
6. Tools are immediately available

**Via API:**

```bash
# Start OAuth flow
curl https://agentc2.ai/api/integrations/microsoft/start \
  -H "Authorization: Bearer $TOKEN"

# Redirects to Microsoft OAuth, then callback stores tokens
# Connection is created automatically
```

### Step 5: Attach tools to agents

List available Microsoft Outlook tools:

```bash
curl https://agentc2.ai/agent/api/tools \
  -H "Authorization: Bearer $TOKEN" \
  | jq '.tools[] | select(.id | startswith("outlook-"))'
```

Attach tools to an agent:

```bash
curl -X POST https://agentc2.ai/agent/api/agents/email-assistant/tools \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "toolId": "outlook-mail-list-emails"
  }'
```

## Environment variables

| Variable                    | Required | Description                                                    |
| --------------------------- | -------- | -------------------------------------------------------------- |
| `MICROSOFT_CLIENT_ID`       | Yes      | Azure AD app client ID                                         |
| `MICROSOFT_CLIENT_SECRET`   | Yes      | Azure AD app client secret                                     |
| `MICROSOFT_TENANT_ID`       | Yes      | Tenant ID (`"common"` for multi-tenant, or specific tenant ID) |
| `CREDENTIAL_ENCRYPTION_KEY` | Yes      | AES-256-GCM encryption key                                     |

<Callout type="tip">
    Use `MICROSOFT_TENANT_ID="common"` for multi-tenant apps (personal + organizational accounts).
    Use a specific tenant ID for single-tenant apps (organization-only).
</Callout>

## Available tools

### Mail tools

| Tool Name                    | Description                               |
| ---------------------------- | ----------------------------------------- |
| `outlook-mail-list-emails`   | List emails in inbox or folder            |
| `outlook-mail-get-email`     | Get email details by ID                   |
| `outlook-mail-send-email`    | Send an email                             |
| `outlook-mail-archive-email` | Archive an email (move to archive folder) |

### Calendar tools

| Tool Name                       | Description                           |
| ------------------------------- | ------------------------------------- |
| `outlook-calendar-list-events`  | List calendar events in date range    |
| `outlook-calendar-get-event`    | Get event details by ID               |
| `outlook-calendar-create-event` | Create a new calendar event           |
| `outlook-calendar-update-event` | Update event details, time, attendees |
| `outlook-calendar-delete-event` | Delete an event                       |

Tool names use the `outlook-mail-` or `outlook-calendar-` prefix. Use the tools API to see the full list with parameter schemas.

## Common patterns

### List emails

```typescript
// Agent receives: "Show me unread emails"
// Agent calls:
{
  tool: "outlook-mail-list-emails",
  arguments: {
    filter: "isRead eq false",
    top: 10
  }
}
// Returns: Array of emails with subjects, senders, previews
```

### Send email

```typescript
// Agent receives: "Send an email to john@example.com about the meeting"
// Agent calls:
{
  tool: "outlook-mail-send-email",
  arguments: {
    to: ["john@example.com"],
    subject: "Meeting tomorrow",
    body: "<p>Hi John,</p><p>Reminder: We have a meeting tomorrow at 3pm.</p>",
    bodyType: "html" // or "text"
  }
}
```

### List calendar events

```typescript
// Agent receives: "What meetings do I have today?"
// Agent calls:
{
  tool: "outlook-calendar-list-events",
  arguments: {
    startDateTime: "2025-02-18T00:00:00Z",
    endDateTime: "2025-02-18T23:59:59Z"
  }
}
// Returns: Array of events with times, subjects, attendees
```

### Create meeting

```typescript
// Agent receives: "Schedule a meeting with john@example.com tomorrow at 3pm"
// Agent calls:
{
  tool: "outlook-calendar-create-event",
  arguments: {
    subject: "Meeting with John",
    body: {
      contentType: "html",
      content: "Discuss project updates"
    },
    start: {
      dateTime: "2025-02-19T15:00:00",
      timeZone: "America/New_York"
    },
    end: {
      dateTime: "2025-02-19T16:00:00",
      timeZone: "America/New_York"
    },
    attendees: [
      {
        emailAddress: {
          address: "john@example.com",
          name: "John Doe"
        },
        type: "required"
      }
    ]
  }
}
```

## Microsoft Graph API features

### OData query syntax

Microsoft Graph uses OData query syntax for filtering:

```typescript
// Filter emails
{
    filter: "isRead eq false and from/emailAddress/address eq 'sender@example.com'";
}

// Filter events
{
    filter: "start/dateTime ge '2025-02-18T00:00:00Z'";
}
```

### Expand relationships

Use `$expand` to include related data:

```typescript
{
  tool: "outlook-mail-list-emails",
  arguments: {
    expand: ["attachments"], // Include attachments
    top: 10
  }
}
```

### Select specific fields

Use `$select` to limit returned fields:

```typescript
{
  tool: "outlook-mail-list-emails",
  arguments: {
    select: ["id", "subject", "from", "receivedDateTime"],
    top: 10
  }
}
```

## Token management

### Automatic refresh

Microsoft tokens are automatically refreshed:

```typescript
// Access tokens expire in ~60-90 minutes
// Refresh tokens last up to 90 days (admin-revocable)
// Automatic refresh on API call
const token = await getMicrosoftToken(connectionId);
if (token.expired) {
    const newToken = await refreshMicrosoftToken(connectionId);
    // New token encrypted and stored
}
```

### Admin consent handling

Enterprise orgs may require admin consent:

```typescript
// OAuth callback detects admin_consent_required
if (error === "admin_consent_required") {
    // Surface clear message to user
    return "Admin consent required. Please contact your IT administrator.";
}
```

### Conditional access

Microsoft may return `interaction_required` during refresh if session invalidated by policy:

```typescript
// Token refresh failed due to conditional access
connection.isActive = false;
connection.errorMessage = "Re-authentication required due to security policy.";
// User must complete OAuth flow again
```

## Troubleshooting

| Problem                        | Solution                                                                                                                   |
| ------------------------------ | -------------------------------------------------------------------------------------------------------------------------- |
| **"Invalid client"**           | Verify `MICROSOFT_CLIENT_ID` and `MICROSOFT_CLIENT_SECRET` are correct. Check redirect URI matches Azure AD config.        |
| **"Admin consent required"**   | Enterprise org requires admin consent. Contact IT admin to grant permissions, or use personal Microsoft account.           |
| **"Token expired"**            | Tokens are automatically refreshed. If refresh fails, user must re-authenticate. Check `CREDENTIAL_ENCRYPTION_KEY` is set. |
| **"Insufficient permissions"** | Ensure API permissions are granted and admin consent provided (if required). Re-authorize if permissions changed.          |
| **"Rate limit exceeded"**      | Microsoft Graph limits: 10,000 requests/10 minutes. Implement exponential backoff and retry logic.                         |
| **"Interaction required"**     | Conditional access policy requires re-authentication. User must complete OAuth flow again.                                 |

## Rate limiting

Microsoft Graph API limits:

- **Per-app rate limit**: 10,000 requests per 10 minutes
- **Per-user rate limit**: Varies by operation
- **Throttling**: Returns `429 Too Many Requests` with `Retry-After` header

Handle rate limits:

```typescript
async function callWithRetry(tool, args, retries = 3) {
    try {
        return await callTool(tool, args);
    } catch (error) {
        if (error.status === 429 && retries > 0) {
            const retryAfter = error.headers["retry-after"] || 60;
            await sleep(retryAfter * 1000);
            return callWithRetry(tool, args, retries - 1);
        }
        throw error;
    }
}
```

## Best practices

### 1. Handle timezones correctly

Always specify timezone for calendar events:

```typescript
{
  start: {
    dateTime: "2025-02-19T15:00:00",
    timeZone: "America/New_York" // Explicit timezone
  }
}
```

### 2. Use filters efficiently

Reduce API calls with OData filters:

```typescript
{
  tool: "outlook-mail-list-emails",
  arguments: {
    filter: "isRead eq false and receivedDateTime ge 2025-02-18T00:00:00Z",
    top: 20
  }
}
```

### 3. Batch operations

When possible, batch multiple operations:

```typescript
// Use batch requests (if supported by tool)
// Or use Promise.all for parallel independent operations
const [emails, events] = await Promise.all([
    callTool("outlook-mail-list-emails", {}),
    callTool("outlook-calendar-list-events", {})
]);
```

## Related topics

- **[Integrations Overview](/docs/integrations/overview)** — Learn about integration architecture
- **[Microsoft Teams](/docs/integrations/microsoft-teams)** — Teams integration
- **[Agent Tools](/docs/agents/tools)** — Attach tools to agents
