---
title: "Dropbox"
description: "Connect agents to Dropbox for file storage, sharing, and search via Dropbox OAuth2 with encrypted token storage."
section: "integrations"
order: 12
primaryKeyword: "Dropbox integration"
relatedSlugs: ["integrations/overview", "integrations/google-drive", "agents/tools"]
pageType: "how-to"
ctaLabel: "Explore Integrations in AgentC2"
ctaHref: "/workspace"
---

# Dropbox

Dropbox integration enables agents to list files, read documents, upload files, search content, and manage sharing links using Dropbox OAuth2 authentication. Tokens are encrypted at rest using AES-256-GCM, and the integration automatically refreshes expired tokens.

## Overview

The Dropbox integration provides OAuth-native tools that agents can call during conversations. Agents can search for files, read document contents, upload new files, and generate sharing links—all while respecting Dropbox's API rate limits and file permissions.

<Callout type="info">
    Dropbox integration uses OAuth2 with PKCE (Proof Key for Code Exchange) for secure
    authentication. Tokens are encrypted before storage and automatically refreshed when expired.
</Callout>

## Prerequisites

- Dropbox account
- Dropbox app created at [dropbox.com/developers](https://www.dropbox.com/developers)
- OAuth2 app key and secret
- Required scopes authorized

## Setup

### Step 1: Create Dropbox app

1. Go to [Dropbox App Console](https://www.dropbox.com/developers/apps)
2. Click **Create app**
3. Choose API: **Dropbox API**
4. Type: **Full Dropbox** (or **App folder** for restricted access)
5. Name your app: "AgentC2 Integration"
6. Click **Create app**

### Step 2: Configure OAuth

1. In app settings, go to **OAuth 2** section
2. Add redirect URI: `https://your-domain/api/integrations/dropbox/callback`
3. Note **App key** (this is your OAuth client ID)
4. Generate **App secret** (this is your OAuth client secret)
5. Copy both values

### Step 3: Configure scopes

Dropbox uses scope strings in the `scope` query parameter:

Required scopes:

- `files.metadata.read` - Read file and folder metadata
- `files.content.read` - Read file contents
- `files.content.write` - Write files
- `sharing.read` - Read sharing information

<Callout type="tip">
    Use `files.content.read` + `files.content.write` for full file access. Use `files.metadata.read`
    only if agents don't need file contents.
</Callout>

### Step 4: Configure in AgentC2

**Environment variables:**

```bash
DROPBOX_APP_KEY="your-app-key"
DROPBOX_APP_SECRET="your-app-secret"
CREDENTIAL_ENCRYPTION_KEY="..." # Generate with: openssl rand -hex 32
```

**Via UI:**

1. Navigate to **Settings > Integrations**
2. Find **Dropbox** and click **Connect**
3. Click **Connect via Dropbox Sign-In**
4. Authorize AgentC2 to access Dropbox
5. Tokens are automatically stored encrypted
6. Tools are immediately available

**Via API:**

```bash
# Start OAuth flow
curl https://agentc2.ai/api/integrations/dropbox/start \
  -H "Authorization: Bearer $TOKEN"

# Redirects to Dropbox OAuth, then callback stores tokens
# Connection is created automatically
```

### Step 5: Attach tools to agents

List available Dropbox tools:

```bash
curl https://agentc2.ai/agent/api/tools \
  -H "Authorization: Bearer $TOKEN" \
  | jq '.tools[] | select(.id | startswith("dropbox-"))'
```

Attach tools to an agent:

```bash
curl -X POST https://agentc2.ai/agent/api/agents/file-assistant/tools \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "toolId": "dropbox-list-files"
  }'
```

## Environment variables

| Variable                    | Required | Description                              |
| --------------------------- | -------- | ---------------------------------------- |
| `DROPBOX_APP_KEY`           | Yes      | Dropbox app key (OAuth client ID)        |
| `DROPBOX_APP_SECRET`        | Yes      | Dropbox app secret (OAuth client secret) |
| `CREDENTIAL_ENCRYPTION_KEY` | Yes      | AES-256-GCM encryption key (32-byte hex) |

<Callout type="warning">
    `CREDENTIAL_ENCRYPTION_KEY` must be set for production. Generate with `openssl rand -hex 32` and
    store securely. Losing this key means all encrypted tokens become unrecoverable.
</Callout>

## Available tools

| Tool Name                   | Description                           |
| --------------------------- | ------------------------------------- |
| `dropbox-list-files`        | List files and folders in a directory |
| `dropbox-get-file`          | Read file contents                    |
| `dropbox-upload-file`       | Upload a file to Dropbox              |
| `dropbox-search-files`      | Search files by name or content       |
| `dropbox-get-sharing-links` | Get sharing links for files/folders   |

Tool names use the `dropbox-` prefix. Use the tools API to see the full list with parameter schemas.

## Common patterns

### List files in folder

```typescript
// Agent receives: "Show me files in the Documents folder"
// Agent calls:
{
  tool: "dropbox-list-files",
  arguments: {
    path: "/Documents",
    recursive: false
  }
}
// Returns: Array of file/folder metadata (name, path, size, modified)
```

### Read file

```typescript
// Agent receives: "Read the budget spreadsheet"
// Agent calls:
{
  tool: "dropbox-search-files",
  arguments: {
    query: "budget spreadsheet",
    maxResults: 1
  }
}
// Then:
{
  tool: "dropbox-get-file",
  arguments: {
    path: "/Documents/budget.xlsx" // Path from search
  }
}
// Returns: File contents (as binary or text depending on file type)
```

### Upload file

```typescript
// Agent receives: "Upload a file called notes.txt with 'Meeting notes'"
// Agent calls:
{
  tool: "dropbox-upload-file",
  arguments: {
    path: "/Documents/notes.txt",
    contents: "Meeting notes",
    mode: "add" // or "overwrite", "update"
  }
}
// Returns: File metadata with path, size, modified time
```

### Get sharing link

```typescript
// Agent receives: "Get a sharing link for the report"
// Agent calls:
{
  tool: "dropbox-search-files",
  arguments: {
    query: "report",
    maxResults: 1
  }
}
// Then:
{
  tool: "dropbox-get-sharing-links",
  arguments: {
    path: "/Documents/report.pdf"
  }
}
// Returns: Sharing link (view_link or download_link)
```

## File paths

Dropbox uses Unix-style paths:

- **Root**: `/` (for Full Dropbox) or `/Apps/YourApp/` (for App folder)
- **Folders**: `/Documents/`, `/Photos/`, etc.
- **Files**: `/Documents/file.txt`

<Callout type="warning">
    Path names are case-sensitive. Use exact paths as shown in Dropbox. Use `dropbox-list-files` to
    discover correct paths.
</Callout>

## File operations

### Upload modes

```typescript
{
    mode: "add"; // Fail if file exists
}
{
    mode: "overwrite"; // Replace existing file
}
{
    mode: "update"; // Update if newer revision exists
}
```

### File types

Dropbox supports various file types:

| File Type      | Read Format      | Notes                        |
| -------------- | ---------------- | ---------------------------- |
| **Text files** | Plain text       | `.txt`, `.md`, `.json`, etc. |
| **Images**     | Binary           | `.jpg`, `.png`, `.gif`, etc. |
| **Documents**  | Binary or export | `.pdf`, `.docx`, etc.        |
| **Folders**    | Metadata only    | List contents, not readable  |

<Callout type="tip">
    For Office documents (`.docx`, `.xlsx`, `.pptx`), Dropbox API returns binary content. Consider
    using Dropbox Paper API or converting to text format for agent processing.
</Callout>

## Search queries

Dropbox search supports various operators:

| Query                 | Description                           |
| --------------------- | ------------------------------------- |
| `filename:budget`     | Files with "budget" in filename       |
| `file_extension:pdf`  | Files with PDF extension              |
| `content:meeting`     | Files containing "meeting" in content |
| `modified:2025-01-01` | Files modified on date                |

Combine queries:

```
filename:report file_extension:pdf modified:2025-01-01
```

<Callout type="info">
    Content search requires Dropbox to index file contents. Not all file types are indexed (e.g.,
    images, binary files). Use filename search for better results.
</Callout>

## Sharing links

Dropbox provides two types of sharing links:

- **View link**: `https://www.dropbox.com/s/...` - View file in browser
- **Download link**: Direct download URL (expires)

Generate sharing links:

```typescript
{
  tool: "dropbox-get-sharing-links",
  arguments: {
    path: "/Documents/file.pdf",
    linkType: "view" // or "download"
  }
}
```

## Token management

### Automatic refresh

Dropbox tokens are automatically refreshed:

```typescript
// Access tokens expire in ~4 hours
// Refresh tokens are long-lived
// Automatic refresh on API call
const token = await getDropboxToken(connectionId);
if (token.expired) {
    const newToken = await refreshDropboxToken(connectionId);
    // New token encrypted and stored
}
```

### Token storage

Tokens are encrypted before storage:

```typescript
// Encryption using AES-256-GCM
const encrypted = encrypt(
    JSON.stringify({
        access_token: "...",
        refresh_token: "...",
        expires_at: 1234567890
    }),
    CREDENTIAL_ENCRYPTION_KEY
);

// Stored in IntegrationConnection.credentials
connection.credentials = { encrypted };
```

## Troubleshooting

| Problem                        | Solution                                                                                                                              |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------- |
| **"Invalid credentials"**      | Verify `DROPBOX_APP_KEY` and `DROPBOX_APP_SECRET` are correct. Check redirect URI matches Dropbox app settings.                       |
| **"Token expired"**            | Tokens are automatically refreshed. If refresh fails, user must re-authenticate via OAuth flow.                                       |
| **"Insufficient permissions"** | Ensure OAuth scopes include required permissions (`files.content.read`, `files.content.write`, etc.). Re-authorize if scopes changed. |
| **"File not found"**           | Verify file path is correct (case-sensitive). Use `dropbox-list-files` to discover correct paths.                                     |
| **"Rate limit exceeded"**      | Dropbox API limits: 1,200 requests/hour. Implement exponential backoff for retries.                                                   |
| **"Path not accessible"**      | Check app type (Full Dropbox vs App folder). App folder apps can only access `/Apps/YourApp/` directory.                              |

## Rate limiting

Dropbox API rate limits:

- **Per-app rate limit**: 1,200 requests per hour
- **Per-user rate limit**: Varies by operation
- **Throttling**: Returns `429 Too Many Requests` with `Retry-After` header

Handle rate limits:

```typescript
async function callWithRetry(tool, args, retries = 3) {
    try {
        return await callTool(tool, args);
    } catch (error) {
        if (error.status === 429 && retries > 0) {
            const retryAfter = error.headers["retry-after"] || 3600; // 1 hour default
            await sleep(retryAfter * 1000);
            return callWithRetry(tool, args, retries - 1);
        }
        throw error;
    }
}
```

## Best practices

### 1. Use path discovery

Always use `dropbox-list-files` to discover correct paths:

```typescript
// List root to see structure
const root = await callTool("dropbox-list-files", { path: "/" });
// Then navigate to specific folders
```

### 2. Handle large files

Large files may timeout. Consider chunked uploads or streaming:

```typescript
// For large files, use chunked upload (if supported by tool)
// Or download in chunks
{
  tool: "dropbox-get-file",
  arguments: {
    path: "/large-file.zip",
    range: "bytes=0-1048576" // First 1MB
  }
}
```

### 3. Cache file metadata

Cache frequently accessed file metadata:

```typescript
const cacheKey = `dropbox:file:${path}`;
const cached = await cache.get(cacheKey);
if (cached) return cached;

const file = await callTool("dropbox-get-file", { path });
await cache.set(cacheKey, file, 300); // Cache 5 minutes
```

## Related topics

- **[Integrations Overview](/docs/integrations/overview)** — Learn about integration architecture
- **[Google Drive](/docs/integrations/google-drive)** — Similar file storage integration
- **[Agent Tools](/docs/agents/tools)** — Attach tools to agents
